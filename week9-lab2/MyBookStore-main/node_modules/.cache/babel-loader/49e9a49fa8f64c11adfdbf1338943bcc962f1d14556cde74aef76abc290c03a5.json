{"ast":null,"code":"import _objectSpread from\"/workspaces/befe-660710245/week9-lab2/MyBookStore-main/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useLocation,useParams,useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const EditBookPage=()=>{var _location$state;const{id}=useParams();const location=useLocation();const navigate=useNavigate();const[book,setBook]=useState(((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.book)||null);const[loading,setLoading]=useState(!book);const[error,setError]=useState(null);useEffect(()=>{if(!book){// fetch book data\nconst fetchBook=async()=>{try{setLoading(true);const res=await fetch(\"http://localhost:8080/api/v1/books/\".concat(id));if(!res.ok)throw new Error('Failed to fetch book');const data=await res.json();setBook(data);}catch(err){setError(err.message);}finally{setLoading(false);}};fetchBook();}},[id,book]);const handleSubmit=async e=>{e.preventDefault();try{const res=await fetch(\"http://localhost:8080/api/v1/books/\".concat(id),{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify(book)});if(!res.ok)throw new Error('Failed to update book');navigate('/allbooks');}catch(err){alert('Update failed: '+err.message);}};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"p-8\",children:\"Loading...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{className:\"p-8 text-red-600\",children:[\"Error: \",error]});return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto p-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold mb-4\",children:\"\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\\u0E2B\\u0E19\\u0E31\\u0E07\\u0E2A\\u0E37\\u0E2D\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{value:book.title||'',onChange:e=>setBook(_objectSpread(_objectSpread({},book),{},{title:e.target.value})),className:\"mt-1 block w-full border rounded p-2\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Author\"}),/*#__PURE__*/_jsx(\"input\",{value:book.author||'',onChange:e=>setBook(_objectSpread(_objectSpread({},book),{},{author:e.target.value})),className:\"mt-1 block w-full border rounded p-2\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"px-4 py-2 bg-viridian-600 text-white rounded\",children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>navigate(-1),className:\"px-4 py-2 border rounded\",children:\"Cancel\"})]})]})]});};export default EditBookPage;","map":{"version":3,"names":["React","useState","useEffect","useLocation","useParams","useNavigate","jsx","_jsx","jsxs","_jsxs","EditBookPage","_location$state","id","location","navigate","book","setBook","state","loading","setLoading","error","setError","fetchBook","res","fetch","concat","ok","Error","data","json","err","message","handleSubmit","e","preventDefault","method","headers","body","JSON","stringify","alert","className","children","onSubmit","value","title","onChange","_objectSpread","target","author","type","onClick"],"sources":["/workspaces/befe-660710245/week9-lab2/MyBookStore-main/src/pages/EditBookPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useLocation, useParams, useNavigate } from 'react-router-dom';\n\nconst EditBookPage = () => {\n  const { id } = useParams();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const [book, setBook] = useState(location.state?.book || null);\n  const [loading, setLoading] = useState(!book);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    if (!book) {\n      // fetch book data\n      const fetchBook = async () => {\n        try {\n          setLoading(true);\n          const res = await fetch(`http://localhost:8080/api/v1/books/${id}`);\n          if (!res.ok) throw new Error('Failed to fetch book');\n          const data = await res.json();\n          setBook(data);\n        } catch (err) {\n          setError(err.message);\n        } finally {\n          setLoading(false);\n        }\n      };\n\n      fetchBook();\n    }\n  }, [id, book]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      const res = await fetch(`http://localhost:8080/api/v1/books/${id}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(book),\n      });\n      if (!res.ok) throw new Error('Failed to update book');\n      navigate('/allbooks');\n    } catch (err) {\n      alert('Update failed: ' + err.message);\n    }\n  };\n\n  if (loading) return <div className=\"p-8\">Loading...</div>;\n  if (error) return <div className=\"p-8 text-red-600\">Error: {error}</div>;\n\n  return (\n    <div className=\"container mx-auto p-6\">\n      <h1 className=\"text-2xl font-bold mb-4\">แก้ไขหนังสือ</h1>\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <div>\n          <label className=\"block text-sm font-medium\">Title</label>\n          <input value={book.title || ''} onChange={(e) => setBook({...book, title: e.target.value})} className=\"mt-1 block w-full border rounded p-2\" />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium\">Author</label>\n          <input value={book.author || ''} onChange={(e) => setBook({...book, author: e.target.value})} className=\"mt-1 block w-full border rounded p-2\" />\n        </div>\n        <div className=\"flex gap-2\">\n          <button type=\"submit\" className=\"px-4 py-2 bg-viridian-600 text-white rounded\">Save</button>\n          <button type=\"button\" onClick={() => navigate(-1)} className=\"px-4 py-2 border rounded\">Cancel</button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default EditBookPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}